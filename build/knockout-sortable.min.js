// knockout-sortable 0.8.3 | (c) 2013 Ryan Niemeyer |  http://www.opensource.org/licenses/mit-license
(function(n){typeof define=="function"&&define.amd?define(["knockout","jquery","jquery.ui.sortable"],n):n(window.ko,jQuery)})(function(n,t){var f="ko_sortItem",s="ko_sourceIndex",e="ko_sortList",h="ko_parentList",c="ko_dragItem",r=n.utils.unwrapObservable,i=n.utils.domData.get,u=n.utils.domData.set,l=function(t,r){n.utils.arrayForEach(t,function(n){n.nodeType===1&&(u(n,f,r),u(n,h,i(n.parentNode,e)))})},o=function(t,i){var u={},f=r(t()),e;return f.data?(u[i]=f.data,u.name=f.template):u[i]=t(),n.utils.arrayForEach(["afterAdd","afterRender","as","beforeRemove","includeDestroyed","templateEngine","templateOptions"],function(t){u[t]=f[t]||n.bindingHandlers.sortable[t]}),i==="foreach"&&(u.afterRender?(e=u.afterRender,u.afterRender=function(n,t){l.call(t,n,t),e.call(t,n,t)}):u.afterRender=l),u},a=function(n,t){var u=r(t),i;if(u)for(i=0;i<n;i++)u[i]&&r(u[i]._destroy)&&n++;return n};n.bindingHandlers.sortable={init:function(l,v,y,p,w){var k=t(l),d=r(v())||{},g=o(v,"foreach"),b={},nt,tt,it;return n.utils.arrayForEach(l.childNodes,function(n){n&&n.nodeType!==1&&n.parentNode.removeChild(n)}),t.extend(!0,b,n.bindingHandlers.sortable),d.options&&b.options&&(n.utils.extend(b.options,d.options),delete d.options),n.utils.extend(b,d),b.connectClass&&(n.isObservable(b.allowDrop)||typeof b.allowDrop=="function")?n.computed({read:function(){var t=r(b.allowDrop),i=typeof t=="function"?t.call(this,g.foreach):t;n.utils.toggleDomNodeCssClass(l,b.connectClass,i)},disposeWhenNodeIsRemoved:l},this):n.utils.toggleDomNodeCssClass(l,b.connectClass,b.allowDrop),n.bindingHandlers.template.init(l,function(){return g},y,p,w),nt=b.options.start,tt=b.options.update,it=setTimeout(function(){var o;k.sortable(n.utils.extend(b.options,{start:function(t,i){var r=i.item[0];u(r,s,n.utils.arrayIndexOf(i.item.parent().children(),r)),i.item.find("input:focus").change(),nt&&nt.apply(this,arguments)},over:function(t,r){if(b.hovering){var u,a,v,c,y,l=r.item[0],p=r.placeholder[0],w=i(l,f)||o;u=i(l,h),v=i(l,s),a=i(p.parentNode,e),c=n.utils.arrayIndexOf(r.placeholder.parent().children(),p),u===a&&c>v&&c--,y={item:w,sourceParent:u,sourceParentNode:u&&r.sender||l.parentNode,sourceIndex:v,targetParent:a,targetIndex:c},b.hovering.call(this,y,t,r)}},receive:function(n,t){o=i(t.item[0],c),o&&(o.clone&&(o=o.clone()),b.dragged&&(o=b.dragged.call(this,o,n,t)||o))},update:function(r,c){var y,k,w,p,v,l=c.item[0],nt=c.item.parent()[0],d=i(l,f)||o;if(o=null,d&&(this===nt||t.contains(this,nt))){if(y=i(l,h),w=i(l,s),k=i(l.parentNode,e),p=n.utils.arrayIndexOf(c.item.parent().children(),l),g.includeDestroyed||(w=a(w,y),p=a(p,k)),(b.beforeMove||b.afterMove)&&(v={item:d,sourceParent:y,sourceParentNode:y&&c.sender||l.parentNode,sourceIndex:w,targetParent:k,targetIndex:p,cancelDrop:!1}),b.beforeMove&&(b.beforeMove.call(this,v,r,c),v.cancelDrop)){v.sourceParent?t(v.sourceParent===v.targetParent?this:c.sender).sortable("cancel"):t(l).remove();return}p>=0&&(y&&(y.splice(w,1),n.processAllDeferredBindingUpdates&&n.processAllDeferredBindingUpdates()),k.splice(p,0,d)),u(l,f,null),c.item.remove(),n.processAllDeferredBindingUpdates&&n.processAllDeferredBindingUpdates(),b.afterMove&&b.afterMove.call(this,v,r,c)}tt&&tt.apply(this,arguments)},connectWith:b.connectClass?"."+b.connectClass:!1})),b.isEnabled!==undefined&&n.computed({read:function(){k.sortable(r(b.isEnabled)?"enable":"disable")},disposeWhenNodeIsRemoved:l})},0),n.utils.domNodeDisposal.addDisposeCallback(l,function(){k.data("sortable")&&k.sortable("destroy"),clearTimeout(it)}),{controlsDescendantBindings:!0}},update:function(t,i,r,f,s){var h=o(i,"foreach");u(t,e,h.foreach),n.bindingHandlers.template.update(t,function(){return h},r,f,s)},connectClass:"ko_container",allowDrop:!0,afterMove:null,beforeMove:null,hovering:null,options:{}},n.bindingHandlers.draggable={init:function(i,f,e,s,h){var l=r(f())||{},p=l.options||{},a=n.utils.extend({},n.bindingHandlers.draggable.options),w=o(f,"data"),v=l.connectClass||n.bindingHandlers.draggable.connectClass,y=l.isEnabled!==undefined?l.isEnabled:n.bindingHandlers.draggable.isEnabled;return l=l.data||l,u(i,c,l),n.utils.extend(a,p),a.connectToSortable=v?"."+v:!1,t(i).draggable(a),y!==undefined&&n.computed({read:function(){t(i).draggable(r(y)?"enable":"disable")},disposeWhenNodeIsRemoved:i}),n.bindingHandlers.template.init(i,function(){return w},e,s,h)},update:function(t,i,r,u,f){var e=o(i,"data");return n.bindingHandlers.template.update(t,function(){return e},r,u,f)},connectClass:n.bindingHandlers.sortable.connectClass,options:{helper:"clone"}}});
//@ sourceMappingURL=knockout-sortable.min.js.map